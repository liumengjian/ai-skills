# 八、表单与交互规范

### 1. 表单组件

- 所有标准 antd 输入控件：

  - 必须包含 `allowClear`

  - 必须包含 `placeholder`

- **下拉选择与级联选择搜索功能**：

  - **强制要求**：除提示语明确要求不做搜索的情况下，所有级联选择（`Cascader`）和普通下拉选择（`Select`）**必须**支持搜索功能

  - **实现方式**：
    - `Select` 组件：添加 `showSearch` 属性
    - `Cascader` 组件：添加 `showSearch` 属性

  - **使用示例**：
    ```javascript
    // ✅ 正确：Select 支持搜索
    <Select
      showSearch
      placeholder="请选择"
      allowClear
      filterOption={(input, option) =>
        (option?.label ?? '').toLowerCase().includes(input.toLowerCase())
      }
    >
      <Option value="1">选项1</Option>
      <Option value="2">选项2</Option>
    </Select>

    // ✅ 正确：Cascader 支持搜索
    <Cascader
      showSearch
      placeholder="请选择"
      allowClear
      options={options}
    />
    ```

- **antd/Form 表单布局规则**：

  - 所有表单 `layout` **必须** 使用 `vertical`

- **表单字段占位规则**：

  - 当需求描述或提示语中**未明确给出表单字段名称**时，允许根据字段语义自行定义**临时字段名**

  - 对于此类字段，必须在对应的 `Form.Item` 上添加 `TODO` 注释，用于明确标识该字段为**模拟字段**，并提示后续由开发者进行确认或替换

  - 示例：

    ```javascript
    <Form.Item name="tempFieldName">
      {/* TODO: 此字段为临时占位字段，需确认实际字段名 */}
      <Input placeholder="请输入..." />
    </Form.Item>
    ```

- **数据回填策略 (Data Filling)**：

  在编辑模式下，表单必须支持可靠的数据回填机制，根据业务场景分为以下两种主要来源：

  - **基于上下文的直接回填 (Context-based)**：

    - **适用场景**：通过表格操作栏点击"编辑"打开弹窗

    - **实现规范**：直接将当前表格行对象（Record）作为初始值注入表单

    - **使用条件**：适用于数据结构简单、无需二次查询的场景

  - **基于标识符的异步回填 (ID-based)**：

    - **适用场景**：

      - 通过 URL 携带 ID 进入独立编辑页

      - 弹窗内需展示比列表更详细的数据

    - **实现规范**：**仅当需求描述或提示语中明确要求通过接口获取详情时**，方可采用此方式

    - **实现方式**：外部仅传入唯一标识符（如 `id`），由组件根据 `id` 调用详情接口获取完整数据并回填

### 2. 表单提交

- 所有提交按钮：

  - 必须有 loading 防重提交，loading 字段来源 `declareRequest` 具体参考运行时 MD 文档

### 3. 编辑 / 新建模式

- 新建、编辑共用弹窗或页面：

  - 编辑态必须支持数据回填
