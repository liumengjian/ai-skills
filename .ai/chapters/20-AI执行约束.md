# 十八、AI 执行约束（关键）

> **以下规则是提供给 Cursor / AI 的强约束，不得违反**

1.  **规范强制性**：所有页面实现必须严格符合本手册定义的 UI、交互及代码架构规范。

2.  **禁止擅自补全**：若需求描述不完整或存在歧义，**AI 禁止擅自补全业务逻辑或交互流程**。AI 必须列出所有不确定点，并请求开发者进行明确确认。

   - **接口数据格式询问**：
     - **一般情况**：当用户要求新增接口时，AI **必须** 反问用户："请提供接口返回的数据格式（JSON 示例）"，以便：
       - 识别数据中的枚举值字段并创建枚举值定义
       - 正确配置 `declareRequest` 的响应表达式
       - 确保代码中使用枚举值而非硬编码字符串
     - **例外情况**：如果提示语中明确要求使用【gen-api-code】工具生成接口文件，则无需询问接口数据格式，直接使用工具生成即可

3.  **依赖约束**：禁止引入本手册未声明的第三方组件库或工具库。

4.  **实现一致性**：禁止自定义与规范冲突的实现方式。所有生成的代码应确保在现有工程环境下可直接运行。

5.  **交付标准**：所有实现结果应以可直接用于生产的代码片段形式呈现，并包含必要的规范性注释。

6.  **代码注释规范**：
    - **强制要求**：函数、变量、常量、逻辑判断都必须加上详细的注释
    - **注释内容**：说明代码的作用、业务逻辑、参数含义、返回值等
    - **注释语言**：业务逻辑使用中文注释，技术实现可使用英文
    - **注释示例**：
      ```javascript
      // ✅ 正确：函数有详细注释
      /**
       * 处理用户删除操作
       * @param {Object} record - 用户记录对象，包含用户ID等信息
       * @param {Function} deleteUserAction - 删除用户的接口Action
       * @description 删除前会进行二次确认，删除成功后刷新列表并提示成功
       */
      const handleDelete = (record, deleteUserAction) => {
        // 获取上下文对象，用于显示确认弹窗和提示消息
        const context = useContext(InjectContext);
        
        // 显示删除确认弹窗
        context.modal.confirm({
          title: '确认删除',
          content: `确定要删除用户"${record.name}"吗？`,
          onOk: async () => {
            // 调用删除接口
            await deleteUserAction({ id: record.id });
            // 显示成功提示
            context.message.success('删除成功！');
          },
        });
      };

      // ✅ 正确：变量有详细注释
      // 用户列表数据，包含用户基本信息（姓名、邮箱、状态等）
      const [userList, setUserList] = useState([]);
      
      // 搜索关键词，用于过滤用户列表
      const [searchKeyword, setSearchKeyword] = useState('');

      // ✅ 正确：常量有详细注释
      // 用户状态枚举值：1-启用，2-禁用，3-待审核
      const USER_STATUS = {
        ENABLED: 1,
        DISABLED: 2,
        PENDING: 3,
      };

      // ✅ 正确：逻辑判断有详细注释
      // 根据业务规则：只有状态为"待审核"且当前用户有审核权限的记录才能编辑
      if (record.status === USER_STATUS.PENDING && hasAuditPermission) {
        // 允许编辑操作
        return true;
      }
      ```

7.  **自定义组件事件命名规范**：
    - **命名格式**：统一使用 `onXXX` 格式
    - **命名要求**：事件名称要贴合实际功能，清晰表达事件含义
    - **命名示例**：
      ```javascript
      // ✅ 正确：事件名称贴合功能
      function CustomButton({ onButtonClick, onButtonHover, onButtonFocus }) {
        return <button onClick={onButtonClick}>按钮</button>;
      }

      // ✅ 正确：事件名称清晰表达含义
      function UserForm({ 
        onSubmit,           // 表单提交事件
        onReset,            // 表单重置事件
        onFieldChange,      // 字段变更事件
        onValidateError,    // 校验错误事件
      }) {
        // 组件实现
      }

      // ❌ 错误：事件名称不清晰
      function CustomComponent({ onClick, onChange }) {
        // 无法明确知道 onClick 和 onChange 的具体含义
      }
      ```
