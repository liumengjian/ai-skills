# 十四、环境变量与数据访问

### 1. 主题色变量

- **Less 文件**：使用 `@colorPrimary` 变量

- **JSX 内联样式**：使用 `process.env.app.antd['colorPrimary']` 变量

- **配置来源**：主题色配置来源于根目录 `jjb.config.js` 文件中的 `framework` 属性

- **配置结构**：

  ```javascript
  // jjb.config.js
  {
    framework: {
      antd: {
        colorPrimary: '#1890ff'
      }
    }
  }
  ```

- **访问方式**：在 JSX 代码中通过 `process.env.app.antd['colorPrimary']` 即可访问配置的主题色值

- **扩展支持**：`framework.antd` 配置支持扩展其他 Less 变量，可在 `jjb.config.js` 中配置任意 antd 主题变量

  - **配置示例**：

    ```javascript
    // jjb.config.js
    {
      framework: {
        antd: {
          colorPrimary: '#1890ff',
          borderRadius: 6,
          colorSuccess: '#52c41a',
          // 可扩展其他 antd 主题变量
        }
      }
    }
    ```

  - **Less 文件使用**：配置的变量会自动注入为 Less 变量，在 `.less` 文件中可直接使用 `@colorPrimary`、`@borderRadius` 等变量

  - **JSX 内联样式使用**：通过 `process.env.app.antd['变量名']` 访问扩展的变量

### 2. 接口服务配置

- **接口域名获取**：通过 `process.env.app.API_HOST` 获取应用接口服务域名

- **配置来源**：接口域名配置来源于根目录 `jjb.config.js` 文件中的 `environment` 属性

- **配置结构**：

  ```javascript
  // jjb.config.js
  {
    environment: {
      development: {
        API_HOST: 'https://dev-api.example.com'
      },
      production: {
        API_HOST: 'https://api.example.com'
      }
    }
  }
  ```

- **应用接口环境**：

  - **开发环境接口 HOST**：`http://10.43.250.65`

  - **测试（UAT）环境接口 HOST**：`http://10.43.82.219`

  - **配置示例**：

    ```javascript
    // jjb.config.js
    {
      environment: {
        development: {
          API_HOST: 'http://10.43.250.65'  // 开发环境
        },
        uat: {
          API_HOST: 'http://10.43.82.219'    // 测试（UAT）环境
        },
        production: {
          API_HOST: 'https://api.example.com'  // 生产环境
        }
      }
    }
    ```

- **环境映射机制**：

  - `process.env.app` 对象会根据启动脚本自动映射到对应的环境配置

  - **映射规则**：启动脚本中的环境标识符（如 `development`、`production`）对应 `environment` 对象中的同名键值

  - **示例**：

    - 启动命令：`npm run serve:development` → `process.env.app` 获取 `environment.development` 的配置

    - 启动命令：`npm run serve:production` → `process.env.app` 获取 `environment.production` 的配置

  - **访问方式**：在代码中通过 `process.env.app.API_HOST` 即可访问当前环境对应的接口域名

### 3. 全局环境变量注入

- **配置来源**：全局环境变量配置来源于根目录 `jjb.config.js` 文件中的 `contextInject` 属性

- **配置结构**：

  ```javascript
  // jjb.config.js
  {
    contextInject: {
      appName: '应用名称',
      version: '1.0.0',
      // 可注入任意自定义变量
    }
  }
  ```

- **注入机制**：`contextInject` 中配置的所有属性会自动注入到 `process.env.app` 对象中

- **访问方式**：在代码中通过 `process.env.app.变量名` 访问注入的全局变量

  - **示例**：

    ```javascript
    // 配置
    {
      contextInject: {
        appName: '应用名称'
      }
    }

    // 访问
    const appName = process.env.app.appName; // '应用名称'
    ```

- **使用场景**：适用于需要在代码中全局访问的应用配置信息，如应用名称、版本号、业务标识等

### 4. 认证 Token

- **Token 获取**：通过 `sessionStorage.getItem('token')` 获取认证令牌
