# 十六、权限控制规范

> **重要提示**：以下内容为**旧版权限**的用法说明，新版权限功能仍在测试中，请以最新版本为准。

权限功能来源于 `@cqsjjb/jjb-common-decorator` 依赖包，用于控制页面按钮和功能的访问权限。

### 1. 权限控制方式

系统使用 **Permission** 装饰器获取当前页面的按钮权限列表。

### 2. Permission 使用方式

- **导入方式**：

  ```javascript
  import { Permission } from '@cqsjjb/jjb-common-decorator/permission';
  ```

- **使用方式**：使用装饰器语法包裹组件

  ```javascript
  import React from 'react';
  import { Permission } from '@cqsjjb/jjb-common-decorator/permission';

  function UserList(props) {
    const { permission } = props;
    
    return (
      <div>
        {permission('add') && <Button>新增</Button>}
        {permission('edit') && <Button>编辑</Button>}
        {permission(['add', 'edit']) && <Button>批量操作</Button>}
      </div>
    );
  }

  // 使用 Permission 装饰器
  export default Permission(UserList);
  ```

- **注入的 Props**：

  - `permission(code)`：权限检查方法

    - 参数 `code`：权限码（字符串）或权限码数组

    - 返回值：`boolean`，表示是否有权限

    - 数组参数：传入数组时，只要数组中任意一个权限码存在即返回 `true`

- **权限获取机制**：

  - 组件挂载时自动调用 `/system/operation/menus/list/current/buttons-perms` 接口获取当前页面的按钮权限列表

  - 接口参数：`{ path: window.location.pathname }`

### 3. 权限控制最佳实践

- **按钮权限控制**：

  ```javascript
  // 使用 Permission + permission 方法
  {permission('add') && <Button>新增</Button>}
  ```

- **批量权限控制**：

  ```javascript
  // 多个权限中任意一个有权限即显示
  {permission(['add', 'edit', 'delete']) && <Button>批量操作</Button>}
  ```

- **权限码命名规范**：

  - 使用小驼峰命名，例如：`add`、`edit`、`delete`、`export`、`import`

  - 权限码应与后端接口返回的权限码保持一致

- **注意事项**：

  - 权限加载期间会显示 Loading 状态，确保用户体验
